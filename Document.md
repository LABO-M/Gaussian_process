# 計算用紙
## データ生成
以下の規則にしたがってランダムウォークのデータを生成しましょう．

$$
\begin{align}
    W_{t+1} &= W_t + z_t 
\end{align}
$$

ただし，$z_t$は独立に等確率で生成され，以下のような規則になります．
$$
z_t = 
\left\{ \,
    \begin{aligned}
    & 1 \\
    & 0 \\
    & -1
    \end{aligned}
\right.
$$
### 問題1
$z_t$の期待値，分散，共分散を求めよ．
___
___
___
___
___
___

### 問題2
$W_t$の期待値，分散，共分散を求めよ．
___
___
___
___
___
___
___


## 動径基底関数回帰
基底関数を動径基底関数
$$
\phi_h (x) = \exp{\{-\frac{(x-\mu_h)^2}{\sigma^2}\}}\ , \ (h = -H , \frac{1}{H} - H , ... , - \frac{1}{H}+H , H)
$$

としたときの回帰問題を扱います．

### 問題3
$H=10$として，$\mu_h$を$-1$から$1$まで$0.2$刻みで変化させたときの基底関数のグラフを描け．

___
___
___
___
___
___
___

### 問題4
動径基底関数に$x=3$,$\mu_h=0$,$\sigma=1$を入れたときの値を求めよ．
___
___
___

### 問題5
計画行列$\Phi$は以下のようになる．
$$
\Phi = 
\begin{pmatrix}
\vec{\phi}(x_1) \\
\vec{\phi}(x_2) \\
\vec{\phi}(x_3) \\
・\\
・\\
・\\
\vec{\phi}(x_{N_{train}})  \\
\end{pmatrix} 
\ 
$$

このとき，$\Phi$の形状を求めよ．

また，
$$
\Phi^{\top} \Phi
$$
の形状を求めよ．

___
___
___

### 問題6
2×2行列の場合において，計画行列$X$としたとき

つまり
$$
X = 
\begin{pmatrix}
1 & x_1 \\
1 & x_2 \\
1 & x_3 \\
・& ・\\
・ & ・\\
・ & ・\\
1 &x_{N_{train}}  \\
\end{pmatrix} 
\ :\  N_{train} × 2\ 行列
$$

とするとき
$$
\hat{w}=(X^{\top} X )^{-1}X^{\top} \vec{y}
$$

の各要素がよく知っている線型回帰の式と一致することを示せ．
___
___
___
___
___
___
___
___
___
___
___

### 問題7*
正規方程式を導出せよ．

リッジ回帰の場合は以下の様になる．
$$
\hat{w}=(\Phi^{\top} \Phi + \alpha I)^{-1}\Phi^{\top} \vec{y}
$$

## ガウス過程回帰
データセット$\mathcal{D} = \{ (x_n , y_n ) \} _{n = 1,...,N}$が与えられています．

このデータセットからカーネル$K$を計算し，$\vec{y}$の分布を算出します．

このとき$y_n = f(x_n)$という関係が成り立つとしましょう．

そして，$f$はガウス過程
$$
f～GP(\vec{0} , k(\vec{x},\vec{x}^{'} ))
$$

このとき$y$についてデータをN個を並べたベクトル$\vec{y}$の分布は
$$
\vec{y}～\mathcal{N} (\vec{0} , K)
$$
となります．

ただし，今回カーネルは以下のように定義します．
$$
k(x , x^{'}) = \theta_1 \exp{\left( - \frac{(x - x^{'})^2}{\theta_2} \right)} + \theta_3 \delta(x , x^{'})
$$

まず学習するのは，$\vec{y}$の分布です．

つまり
$$
\vec{y}～\mathcal{N} (\vec{0} , K)
$$
にある$K$の部分を訓練データから学習します．

### 問題8
上で定義したカーネルに対して
$$
k(x=1 , x^{\prime}=1) = \theta_1 \exp{\left( - \frac{(x - x^{'})^2}{\theta_2} \right)} + \theta_3 \delta(x , x^{'})
$$
を計算しなさい．

また，$k(1 , 2)$ではどうか
___
___
___
___

### 問題9
好きなだけカーネル行列の成分を計算して，カーネル行列を書きなさい．

ここで，カーネル行列とは
$$
K^{(train) } = 
\begin{pmatrix}
k(x_1 , x_1) & k(x_1,x_2) & k(x_1,x_3) & ・・・ & k(x_1,x_{N_{train}}) \\
k(x_2,x_1)  & k(x_2,x_2) & k(x_2,x_3) & ・・・ & k(x_2,x_{N_{train}})  \\
k(x_3,x_1)  & k(x_3,x_2) & k(x_3,x_3) & ・・・ & k(x_3,x_{N_{train}}) \\
・& ・& ・& ・・・ & ・\\
・& ・& ・& ・・・ & ・\\
・& ・& ・& ・・・ & ・\\
k(x_{N_{train} }, x_1) & k(x_{N_{train}} , x_2) & k(x_{N_{train}} , x_3) & ・・・ & k(x_{N_{train}} , x_{N_{train}}) \\
\end{pmatrix}
$$

___
___
___
___
___
___
___
___
___

### 問題10
ガウス過程における$\vec{y}$の分布は
$$
\vec{y}～\mathcal{N} (\vec{0} , K)
$$

である．問題9で得たカーネル行列を使い$\vec{y}$の分布を自分なりに書きなさい．
___
___
___
___

### 問題11*
新しいデータ点$x^*$が手に入った時，$y^*$の分布はどうなるか．

この時，$y^*$の予測分布は明示的に以下のようになる

$$
p(y^{*} | \vec{x}^{*} ,\mathcal{D}) = \mathcal{N} (\textbf{k}^{\top}_* K^{-1} \vec{y} , \textbf{k}_{**} - \textbf{k}^{\top}_* K^{-1} \textbf{k}_*)
$$
ただし
$$
\textbf{k}_* = (k(x^*,x_1) , k(x^*,x_2) , k(x^*,x_3) ,.... ,k(x^*,x_{N_{train}}))\top
$$
$$
k_{**} = k(x^*,x^*)
$$

___
___
___
___
___
___
___
___
___
___
___
___
___
___
___
___
___
___
___
___
___
___
___